<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TUNGA NAKANGAKA - Online Shopping</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Global Styles */
        :root {
            --primary: #1a2a6c;
            --secondary: #b21f1f;
            --accent: #fdbb2d;
            --light: #f8f9fa;
            --dark: #333;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        .logo-img {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .menu {
            display: flex;
            list-style: none;
        }
        
        .menu li {
            margin-left: 20px;
        }
        
        .menu a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .menu a:hover {
            color: var(--accent);
        }
        
        .whatsapp-btn {
            background-color: #25D366;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            text-decoration: none;
            display: flex;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .whatsapp-btn:hover {
            background-color: #128C7E;
        }
        
        .whatsapp-btn i {
            margin-right: 5px;
        }
        
        /* Main Content Styles */
        .main-content {
            padding: 30px 0;
            min-height: calc(100vh - 150px);
        }
        
        .page {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Home Page */
        .hero {
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=80') no-repeat center center/cover;
            color: white;
            padding: 80px 0;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .hero h1 {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .hero p {
            font-size: 20px;
            max-width: 700px;
            margin: 0 auto 30px;
        }
        
        .btn {
            display: inline-block;
            background: var(--secondary);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            font-size: 18px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #a11c1c;
        }
        
        .btn-primary {
            background: var(--primary);
        }
        
        .btn-primary:hover {
            background: #15215a;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        
        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .feature-card i {
            font-size: 40px;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        /* Forms */
        .form-container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .password-container {
            position: relative;
        }
        
        .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #666;
        }
        
        /* Products */
        .category-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            flex-wrap: wrap;
        }
        
        .category-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        
        .category-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: bold;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .product-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
        }
        
        .product-image {
            height: 200px;
            background-color: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            position: relative;
        }
        
        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .product-info {
            padding: 15px;
        }
        
        .product-price {
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .add-to-cart {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }
        
        .add-to-cart:hover {
            background: #0d1a4d;
        }
        
        .add-to-cart:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        /* Cart */
        .cart-items {
            margin-bottom: 20px;
        }
        
        .cart-item {
            display: flex;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .cart-item-image {
            width: 80px;
            height: 80px;
            background: #f5f5f5;
            margin-right: 15px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
        }
        
        .cart-item-details {
            flex: 1;
        }
        
        .cart-item-price {
            font-weight: bold;
            color: var(--primary);
        }
        
        .quantity-controls {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        
        .quantity-btn {
            background: #ddd;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .quantity {
            margin: 0 10px;
            font-weight: bold;
        }
        
        .cart-summary {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .total-price {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            margin: 15px 0;
        }
        
        /* Payment */
        .payment-methods {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .payment-method {
            flex: 1;
            min-width: 200px;
            text-align: center;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .payment-method.active {
            border-color: var(--primary);
            background: rgba(26, 42, 108, 0.05);
        }
        
        .payment-details {
            display: none;
        }
        
        .payment-details.active {
            display: block;
        }
        
        /* Reviews */
        .reviews-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .review-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .reviewer {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .reviewer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #ddd;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #666;
        }
        
        .review-rating {
            color: #ffcc00;
            margin-bottom: 10px;
        }
        
        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            z-index: 1000;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            max-width: 400px;
        }
        
        .notification.success {
            background: var(--success);
        }
        
        .notification.error {
            background: var(--danger);
        }
        
        .notification.info {
            background: var(--primary);
        }
        
        .notification i {
            margin-right: 10px;
        }
        
        /* Login Required Overlay */
        .login-required {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        /* Wallet Styles */
        .wallet-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .wallet-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .wallet-balance {
            font-size: 48px;
            font-weight: bold;
            color: var(--primary);
            margin: 20px 0;
        }
        
        .wallet-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        
        .wallet-action {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .wallet-action i {
            font-size: 40px;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .transaction-history {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .transaction-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .transaction-table th, .transaction-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .transaction-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .transaction-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .transaction-type.deposit {
            color: var(--success);
        }
        
        .transaction-type.withdrawal {
            color: var(--danger);
        }
        
        .transaction-type.bonus {
            color: var(--accent);
        }
        
        /* Referral Styles */
        .referral-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .referral-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .referral-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .referral-link-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .referral-link {
            display: flex;
            margin: 15px 0;
        }
        
        .referral-link input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px 0 0 5px;
            font-size: 16px;
        }
        
        .copy-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
        }
        
        .referral-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .referral-table th, .referral-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .referral-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        /* Admin Panel Styles */
        .admin-panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .admin-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .admin-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        
        .admin-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: bold;
        }
        
        .admin-section {
            display: none;
        }
        
        .admin-section.active {
            display: block;
        }
        
        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .admin-table th, .admin-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .admin-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .admin-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .action-btn {
            padding: 6px 12px;
            margin: 0 3px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .edit-btn {
            background-color: var(--warning);
            color: white;
        }
        
        .delete-btn {
            background-color: var(--danger);
            color: white;
        }
        
        .save-btn {
            background-color: var(--success);
            color: white;
        }
        
        /* Footer */
        footer {
            background: var(--primary);
            color: white;
            padding: 30px 0;
            text-align: center;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .footer-section h3 {
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .footer-section ul {
            list-style: none;
        }
        
        .footer-section ul li {
            margin-bottom: 10px;
        }
        
        .footer-section a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-section a:hover {
            color: var(--accent);
        }
        
        .copyright {
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
            }
            
            .menu {
                margin-top: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .menu li {
                margin: 5px 10px;
            }
            
            .hero h1 {
                font-size: 36px;
            }
            
            .hero p {
                font-size: 18px;
            }
            
            .payment-methods {
                flex-direction: column;
            }
            
            .wallet-actions {
                grid-template-columns: 1fr;
            }
            
            .admin-tabs {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-img">TN</div>
                    <span>TUNGA NAKANGAKA</span>
                </div>
                <ul class="menu">
                    <li><a href="#" class="menu-link" data-page="home">Home</a></li>
                    <li><a href="#" class="menu-link" data-page="products">Products</a></li>
                    <li><a href="#" class="menu-link" data-page="cart">Cart</a></li>
                    <li><a href="#" class="menu-link" data-page="wallet">Wallet</a></li>
                    <li><a href="#" class="menu-link" data-page="referral">Invite & Earn</a></li>
                    <li><a href="#" class="menu-link" data-page="contact">Contact</a></li>
                    <li><a href="#" class="menu-link" id="login-link">Login</a></li>
                    <li><a href="#" class="menu-link" id="signup-link">Sign Up</a></li>
                    <li><a href="#" class="menu-link" id="admin-link" style="display: none;">Admin</a></li>
                </ul>
                <a href="https://wa.me/250732388667" class="whatsapp-btn" target="_blank">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <!-- Home Page -->
            <div id="home" class="page active">
                <div class="hero">
                    <h1>Welcome to TUNGA NAKANGAKA</h1>
                    <p>Your one-stop shop for quality Nike shoes, fashionable clothing, and delicious food products</p>
                    <a href="#" class="btn menu-link" data-page="products">Shop Now</a>
                </div>
                
                <div class="features">
                    <div class="feature-card">
                        <i class="fas fa-shoe-prints"></i>
                        <h3>Quality Shoes</h3>
                        <p>Latest Nike collections for men, women and children</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-tshirt"></i>
                        <h3>Fashion Clothing</h3>
                        <p>Trendy outfits for all occasions and seasons</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-utensils"></i>
                        <h3>Food Products</h3>
                        <p>Delicious and healthy food options</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-shipping-fast"></i>
                        <h3>Fast Delivery</h3>
                        <p>Quick delivery to Musanze, Cyuve, Rwebeya and Kungo</p>
                    </div>
                </div>
                
                <div style="margin-top: 50px;">
                    <h2 style="text-align: center; margin-bottom: 30px;">Customer Reviews</h2>
                    <div class="reviews-container">
                        <div class="review-card">
                            <div class="reviewer">
                                <div class="reviewer-avatar">MG</div>
                                <div>
                                    <h4>Mizero Gervais</h4>
                                    <div class="review-rating">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </div>
                                </div>
                            </div>
                            <p>"The quality of Nike shoes I purchased exceeded my expectations. Fast delivery and excellent customer service!"</p>
                        </div>
                        <div class="review-card">
                            <div class="reviewer">
                                <div class="reviewer-avatar">MJ</div>
                                <div>
                                    <h4>Migambi Johnson</h4>
                                    <div class="review-rating">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star-half-alt"></i>
                                    </div>
                                </div>
                            </div>
                            <p>"Great variety of clothing for the whole family. Prices are reasonable and the products are durable."</p>
                        </div>
                        <div class="review-card">
                            <div class="reviewer">
                                <div class="reviewer-avatar">II</div>
                                <div>
                                    <h4>Irambona Israel</h4>
                                    <div class="review-rating">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </div>
                                </div>
                            </div>
                            <p>"The food products are fresh and delicious. I especially love their selection of local specialties."</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Page -->
            <div id="products" class="page">
                <h1>Our Products</h1>
                <div class="category-tabs">
                    <div class="category-tab active" data-category="men">Men</div>
                    <div class="category-tab" data-category="women">Women</div>
                    <div class="category-tab" data-category="children">Children</div>
                    <div class="category-tab" data-category="food">Food</div>
                </div>
                
                <div class="products-grid" id="products-container">
                    <!-- Products will be dynamically added here -->
                </div>
            </div>

            <!-- Cart Page -->
            <div id="cart" class="page">
                <h1>Shopping Cart</h1>
                <div class="cart-items">
                    <!-- Cart items will be dynamically added here -->
                </div>
                
                <div class="cart-summary">
                    <h2>Order Summary</h2>
                    <div class="total-price">Total: 0 RWF</div>
                    <button class="btn" id="checkout-btn">Proceed to Checkout</button>
                </div>
            </div>

            <!-- Wallet Page -->
            <div id="wallet" class="page">
                <h1>My Wallet</h1>
                <div class="wallet-container">
                    <div class="wallet-card">
                        <h2>Current Balance</h2>
                        <div class="wallet-balance" id="wallet-balance">$0.00</div>
                        <p>Available for shopping or withdrawal</p>
                    </div>
                    
                    <div class="wallet-actions">
                        <div class="wallet-action">
                            <i class="fas fa-money-bill-wave"></i>
                            <h3>Deposit Funds</h3>
                            <p>Add money to your wallet</p>
                            <button class="btn" id="deposit-btn" style="margin-top: 15px;">Deposit</button>
                        </div>
                        
                        <div class="wallet-action">
                            <i class="fas fa-hand-holding-usd"></i>
                            <h3>Withdraw Funds</h3>
                            <p>Withdraw money to your bank account</p>
                            <button class="btn" id="withdraw-btn" style="margin-top: 15px;">Withdraw</button>
                        </div>
                    </div>
                    
                    <div class="transaction-history">
                        <h2>Transaction History</h2>
                        <table class="transaction-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="transaction-history">
                                <!-- Transactions will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Referral Page -->
            <div id="referral" class="page">
                <h1>Invite & Earn</h1>
                <div class="referral-container">
                    <div class="referral-card">
                        <h2>Earn $6 for Every Friend You Refer!</h2>
                        <p>Share your referral link with friends and earn $6 when they make their first deposit of $5 or more.</p>
                        
                        <div class="referral-stats">
                            <div class="stat-card">
                                <h3>Total Referrals</h3>
                                <div class="stat-value" id="total-referrals">0</div>
                                <p>People you've invited</p>
                            </div>
                            <div class="stat-card">
                                <h3>Earned Bonus</h3>
                                <div class="stat-value" id="total-bonus">$0</div>
                                <p>From referrals</p>
                            </div>
                            <div class="stat-card">
                                <h3>Pending Bonus</h3>
                                <div class="stat-value" id="pending-bonus">$0</div>
                                <p>Awaiting deposit</p>
                            </div>
                        </div>
                        
                        <div class="referral-link-container">
                            <h3>Your Referral Link</h3>
                            <div class="referral-link">
                                <input type="text" id="referral-link-input" readonly>
                                <button class="copy-btn" id="copy-referral-link">Copy</button>
                            </div>
                            <p>Share this link with your friends to start earning!</p>
                        </div>
                    </div>
                    
                    <div class="transaction-history">
                        <h2>Referral History</h2>
                        <table class="referral-table">
                            <thead>
                                <tr>
                                    <th>Friend Name</th>
                                    <th>Date Joined</th>
                                    <th>First Deposit</th>
                                    <th>Bonus Status</th>
                                    <th>Bonus Amount</th>
                                </tr>
                            </thead>
                            <tbody id="referral-history">
                                <!-- Referral history will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Contact Page -->
            <div id="contact" class="page">
                <h1>Contact Us</h1>
                <div class="form-container">
                    <div class="form-group">
                        <label for="contact-name">Full Name</label>
                        <input type="text" id="contact-name" class="form-control" placeholder="Enter your name">
                    </div>
                    <div class="form-group">
                        <label for="contact-email">Email Address</label>
                        <input type="email" id="contact-email" class="form-control" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="contact-phone">Phone Number</label>
                        <input type="tel" id="contact-phone" class="form-control" placeholder="Enter your phone number">
                    </div>
                    <div class="form-group">
                        <label for="contact-message">Message</label>
                        <textarea id="contact-message" class="form-control" rows="5" placeholder="Enter your message"></textarea>
                    </div>
                    <button class="btn" id="contact-submit">Send Message</button>
                </div>
                
                <div style="margin-top: 40px;">
                    <h2>Our Locations</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div>
                            <h3>Musanze</h3>
                            <p>Main Street, Musanze City</p>
                        </div>
                        <div>
                            <h3>Cyuve</h3>
                            <p>Market Area, Cyuve Sector</p>
                        </div>
                        <div>
                            <h3>Rwebeya</h3>
                            <p>Central Market, Rwebeya</p>
                        </div>
                        <div>
                            <h3>Kungo</h3>
                            <p>Commercial Center, Kungo</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Login Page -->
            <div id="login" class="page">
                <h1>Login to Your Account</h1>
                <div class="form-container">
                    <div class="form-group">
                        <label for="login-email">Email or Phone Number</label>
                        <input type="text" id="login-email" class="form-control" placeholder="Enter your email or phone number">
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <div class="password-container">
                            <input type="password" id="login-password" class="form-control" placeholder="Enter your password">
                            <span class="toggle-password" data-target="login-password">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                    <button class="btn" id="login-btn">Login</button>
                    <p style="text-align: center; margin-top: 15px;">
                        <a href="#" class="menu-link" data-page="forgot-password">Forgot Password?</a>
                    </p>
                    <p style="text-align: center; margin-top: 15px;">
                        Don't have an account? <a href="#" class="menu-link" data-page="signup">Sign Up</a>
                    </p>
                </div>
            </div>

            <!-- Signup Page -->
            <div id="signup" class="page">
                <h1>Create an Account</h1>
                <div class="form-container">
                    <div class="form-group">
                        <label for="signup-name">Full Name</label>
                        <input type="text" id="signup-name" class="form-control" placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label for="signup-email">Email Address</label>
                        <input type="email" id="signup-email" class="form-control" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="signup-phone">Phone Number</label>
                        <input type="tel" id="signup-phone" class="form-control" placeholder="Enter your phone number">
                    </div>
                    <div class="form-group">
                        <label for="signup-password">Password</label>
                        <div class="password-container">
                            <input type="password" id="signup-password" class="form-control" placeholder="At least 8 characters with number, uppercase, and symbol">
                            <span class="toggle-password" data-target="signup-password">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="referral-code">Referral Code (Optional)</label>
                        <input type="text" id="referral-code" class="form-control" placeholder="Enter referral code if you have one">
                    </div>
                    <button class="btn" id="signup-btn">Send Verification Code</button>
                    <p style="text-align: center; margin-top: 15px;">
                        Already have an account? <a href="#" class="menu-link" data-page="login">Login</a>
                    </p>
                </div>
            </div>

            <!-- Forgot Password Page -->
            <div id="forgot-password" class="page">
                <h1>Reset Your Password</h1>
                <div class="form-container">
                    <div class="form-group">
                        <label for="reset-email">Email Address</label>
                        <input type="email" id="reset-email" class="form-control" placeholder="Enter your email address">
                    </div>
                    <button class="btn" id="reset-btn">Send Reset Code</button>
                    <p style="text-align: center; margin-top: 15px;">
                        Remember your password? <a href="#" class="menu-link" data-page="login">Login</a>
                    </p>
                </div>
            </div>

            <!-- Reset Password with Code Page -->
            <div id="reset-password" class="page">
                <h1>Reset Your Password</h1>
                <div class="form-container">
                    <div class="form-group">
                        <label for="reset-code">Verification Code</label>
                        <input type="text" id="reset-code" class="form-control" placeholder="Enter the code sent to your email">
                    </div>
                    <div class="form-group">
                        <label for="new-password">New Password</label>
                        <div class="password-container">
                            <input type="password" id="new-password" class="form-control" placeholder="Enter your new password">
                            <span class="toggle-password" data-target="new-password">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirm New Password</label>
                        <div class="password-container">
                            <input type="password" id="confirm-password" class="form-control" placeholder="Confirm your new password">
                            <span class="toggle-password" data-target="confirm-password">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </div>
                    <button class="btn" id="reset-password-btn">Reset Password</button>
                    <p style="text-align: center; margin-top: 15px;">
                        <a href="#" class="menu-link" data-page="forgot-password">Resend Code</a>
                    </p>
                </div>
            </div>

            <!-- Payment Page -->
            <div id="payment" class="page">
                <h1>Complete Your Purchase</h1>
                <div class="form-container">
                    <h2>Select Payment Method</h2>
                    <div class="payment-methods">
                        <div class="payment-method active" data-method="mobile">
                            <h3>Mobile Money</h3>
                            <p>Pay with MTN or Airtel</p>
                        </div>
                        <div class="payment-method" data-method="binance">
                            <h3>Binance</h3>
                            <p>Pay with cryptocurrency</p>
                        </div>
                        <div class="payment-method" data-method="wallet">
                            <h3>Wallet Balance</h3>
                            <p>Pay with your wallet funds</p>
                        </div>
                    </div>
                    
                    <div class="payment-details active" id="mobile-payment">
                        <div class="form-group">
                            <label for="mobile-number">Phone Number</label>
                            <input type="tel" id="mobile-number" class="form-control" value="0794633684" readonly>
                        </div>
                        <div class="form-group">
                            <label for="payment-amount">Amount to Pay</label>
                            <input type="text" id="payment-amount" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label for="payment-proof">Upload Payment Proof (Screenshot)</label>
                            <input type="file" id="payment-proof" class="form-control">
                        </div>
                        <button class="btn" id="submit-mobile-payment">Submit Payment</button>
                    </div>
                    
                    <div class="payment-details" id="binance-payment">
                        <div class="form-group">
                            <label for="binance-email">Binance Email</label>
                            <input type="email" id="binance-email" class="form-control" value="uragiwenimanapatrick26@gmail.com" readonly>
                        </div>
                        <div class="form-group">
                            <label for="binance-amount">Amount to Pay (USD)</label>
                            <input type="text" id="binance-amount" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label for="binance-proof">Upload Payment Proof (Screenshot)</label>
                            <input type="file" id="binance-proof" class="form-control">
                        </div>
                        <button class="btn" id="submit-binance-payment">Submit Payment</button>
                    </div>
                    
                    <div class="payment-details" id="wallet-payment">
                        <div class="form-group">
                            <label for="wallet-balance-display">Available Balance</label>
                            <input type="text" id="wallet-balance-display" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label for="wallet-payment-amount">Amount to Pay</label>
                            <input type="text" id="wallet-payment-amount" class="form-control" readonly>
                        </div>
                        <button class="btn" id="submit-wallet-payment">Pay with Wallet</button>
                    </div>
                </div>
            </div>

            <!-- Admin Panel -->
            <div id="admin" class="page">
                <h1>Business Owner Dashboard</h1>
                <div class="admin-panel">
                    <div class="admin-tabs">
                        <div class="admin-tab active" data-section="products">Manage Products</div>
                        <div class="admin-tab" data-section="orders">Manage Orders</div>
                        <div class="admin-tab" data-section="locations">Business Locations</div>
                        <div class="admin-tab" data-section="payments">Payment Settings</div>
                        <div class="admin-tab" data-section="wallet-transactions">Wallet Transactions</div>
                    </div>
                    
                    <!-- Products Management -->
                    <div id="admin-products" class="admin-section active">
                        <h2>Product Management</h2>
                        <button class="btn" id="add-product-btn">Add New Product</button>
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Category</th>
                                    <th>Price (RWF)</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-products-table">
                                <!-- Products will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Orders Management -->
                    <div id="admin-orders" class="admin-section">
                        <h2>Order Management</h2>
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-orders-table">
                                <!-- Orders will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Locations Management -->
                    <div id="admin-locations" class="admin-section">
                        <h2>Business Locations</h2>
                        <button class="btn" id="add-location-btn">Add New Location</button>
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Location</th>
                                    <th>Address</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-locations-table">
                                <!-- Locations will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Payment Settings -->
                    <div id="admin-payments" class="admin-section">
                        <h2>Payment Settings</h2>
                        <div class="form-container">
                            <div class="form-group">
                                <label for="mobile-money-number">Mobile Money Number</label>
                                <input type="text" id="mobile-money-number" class="form-control" value="0794633684">
                            </div>
                            <div class="form-group">
                                <label for="binance-email-admin">Binance Email</label>
                                <input type="email" id="binance-email-admin" class="form-control" value="uragiwenimanapatrick26@gmail.com">
                            </div>
                            <button class="btn" id="save-payment-settings">Save Payment Settings</button>
                        </div>
                    </div>
                    
                    <!-- Wallet Transactions -->
                    <div id="admin-wallet-transactions" class="admin-section">
                        <h2>Wallet Transactions</h2>
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-wallet-transactions-table">
                                <!-- Wallet transactions will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>TUNGA NAKANGAKA</h3>
                    <p>Your trusted online shopping destination for quality products at affordable prices.</p>
                    <p>Established: November 2025</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#" class="menu-link" data-page="home">Home</a></li>
                        <li><a href="#" class="menu-link" data-page="products">Products</a></li>
                        <li><a href="#" class="menu-link" data-page="contact">Contact Us</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact Info</h3>
                    <ul>
                        <li>Phone: 0794633684</li>
                        <li>Email: uragiwenimanapatrick26@gmail.com</li>
                        <li>WhatsApp: 0732388667</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Business Locations</h3>
                    <ul>
                        <li>Musanze</li>
                        <li>Cyuve</li>
                        <li>Rwebeya</li>
                        <li>Kungo</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 TUNGA NAKANGAKA. All rights reserved. Owned by Uragiwenimana Patrick.</p>
            </div>
        </div>
    </footer>

    <!-- Deposit Modal -->
    <div id="deposit-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 500px;">
            <h2>Deposit Funds</h2>
            <div class="form-group">
                <label for="deposit-amount">Amount (USD)</label>
                <input type="number" id="deposit-amount" class="form-control" placeholder="Enter amount ($5 - $30,000)" min="5" max="30000">
                <small>Minimum: $5, Maximum: $30,000</small>
            </div>
            <div class="form-group">
                <label for="deposit-method">Payment Method</label>
                <select id="deposit-method" class="form-control">
                    <option value="mobile">Mobile Money</option>
                    <option value="binance">Binance</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn" id="confirm-deposit">Confirm Deposit</button>
                <button class="btn" style="background: #6c757d;" id="cancel-deposit">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Withdrawal Modal -->
    <div id="withdrawal-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 500px;">
            <h2>Withdraw Funds</h2>
            <div class="form-group">
                <label for="withdrawal-amount">Amount (USD)</label>
                <input type="number" id="withdrawal-amount" class="form-control" placeholder="Enter amount ($5 - $30,000)" min="5" max="30000">
                <small>Minimum: $5, Maximum: $30,000</small>
            </div>
            <div class="form-group">
                <label for="withdrawal-method">Withdrawal Method</label>
                <select id="withdrawal-method" class="form-control">
                    <option value="bank">Bank Transfer</option>
                    <option value="mobile">Mobile Money</option>
                </select>
            </div>
            <div class="form-group">
                <label for="account-details">Account Details</label>
                <input type="text" id="account-details" class="form-control" placeholder="Enter your account number or phone number">
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn" id="confirm-withdrawal">Confirm Withdrawal</button>
                <button class="btn" style="background: #6c757d;" id="cancel-withdrawal">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // Company email for notifications
        const COMPANY_EMAIL = "uragiwenimanapatrick26@gmail.com";
        
        // User authentication state
        let isLoggedIn = false;
        let currentUser = null;
        let isAdmin = false;
        
        // Database keys for localStorage
        const DB_KEYS = {
            USERS: 'tunga_nakangaka_users',
            PRODUCTS: 'tunga_nakangaka_products',
            ORDERS: 'tunga_nakangaka_orders',
            CART: 'tunga_nakangaka_cart',
            LOCATIONS: 'tunga_nakangaka_locations',
            PAYMENT_SETTINGS: 'tunga_nakangaka_payment_settings',
            RESET_CODES: 'tunga_nakangaka_reset_codes',
            WALLET_TRANSACTIONS: 'tunga_nakangaka_wallet_transactions',
            REFERRALS: 'tunga_nakangaka_referrals'
        };
        
        // Initialize database
        function initializeDatabase() {
            // Check if users exist in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.USERS)) {
                const defaultUsers = [
                    {
                        id: 1,
                        name: "Business Owner",
                        email: "owner@tunganakangaka.com",
                        phone: "0794633684",
                        password: "Admin123!",
                        isAdmin: true,
                        walletBalance: 0,
                        referralCode: generateReferralCode(),
                        referredBy: null
                    }
                ];
                localStorage.setItem(DB_KEYS.USERS, JSON.stringify(defaultUsers));
            }
            
            // Check if products exist in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.PRODUCTS)) {
                localStorage.setItem(DB_KEYS.PRODUCTS, JSON.stringify(products));
            }
            
            // Check if orders exist in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.ORDERS)) {
                localStorage.setItem(DB_KEYS.ORDERS, JSON.stringify([]));
            }
            
            // Check if cart exists in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.CART)) {
                localStorage.setItem(DB_KEYS.CART, JSON.stringify([]));
            }
            
            // Check if locations exist in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.LOCATIONS)) {
                const defaultLocations = [
                    { id: 1, name: "Musanze", address: "Main Street, Musanze City", active: true },
                    { id: 2, name: "Cyuve", address: "Market Area, Cyuve Sector", active: true },
                    { id: 3, name: "Rwebeya", address: "Central Market, Rwebeya", active: true },
                    { id: 4, name: "Kungo", address: "Commercial Center, Kungo", active: true }
                ];
                localStorage.setItem(DB_KEYS.LOCATIONS, JSON.stringify(defaultLocations));
            }
            
            // Check if payment settings exist in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.PAYMENT_SETTINGS)) {
                const defaultPaymentSettings = {
                    mobileMoneyNumber: "0794633684",
                    binanceEmail: "uragiwenimanapatrick26@gmail.com"
                };
                localStorage.setItem(DB_KEYS.PAYMENT_SETTINGS, JSON.stringify(defaultPaymentSettings));
            }
            
            // Check if reset codes exist in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.RESET_CODES)) {
                localStorage.setItem(DB_KEYS.RESET_CODES, JSON.stringify([]));
            }
            
            // Check if wallet transactions exist in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.WALLET_TRANSACTIONS)) {
                localStorage.setItem(DB_KEYS.WALLET_TRANSACTIONS, JSON.stringify([]));
            }
            
            // Check if referrals exist in localStorage, if not create default
            if (!localStorage.getItem(DB_KEYS.REFERRALS)) {
                localStorage.setItem(DB_KEYS.REFERRALS, JSON.stringify([]));
            }
        }
        
        // Get data from database
        function getFromDB(key) {
            const data = localStorage.getItem(key);
            return data ? JSON.parse(data) : null;
        }
        
        // Save data to database
        function saveToDB(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }
        
        // Generate referral code
        function generateReferralCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }
        
        // Product data
        const products = {
            men: [
                { id: 1, name: "Nike Air Max", price: 25000, rwf: 25000, usd: 25, category: "men", image: "Nike Air Max" },
                { id: 2, name: "Nike Air Force", price: 30000, rwf: 30000, usd: 30, category: "men", image: "Nike Air Force" },
                { id: 3, name: "Puma T-Shirt", price: 12000, rwf: 12000, usd: 12, category: "men", image: "Puma T-Shirt" },
                { id: 4, name: "Men's Jumper", price: 18000, rwf: 18000, usd: 18, category: "men", image: "Men's Jumper" },
                { id: 5, name: "Men's Trouser", price: 15000, rwf: 15000, usd: 15, category: "men", image: "Men's Trouser" }
            ],
            women: [
                { id: 6, name: "Women's High Heels", price: 35000, rwf: 35000, usd: 35, category: "women", image: "High Heels" },
                { id: 7, name: "Women's Long Trouser", price: 18000, rwf: 18000, usd: 18, category: "women", image: "Long Trouser" },
                { id: 8, name: "Women's T-Shirt", price: 12000, rwf: 12000, usd: 12, category: "women", image: "Women's T-Shirt" },
                { id: 9, name: "Women's Dress", price: 25000, rwf: 25000, usd: 25, category: "women", image: "Women's Dress" },
                { id: 10, name: "Women's Handbag", price: 30000, rwf: 30000, usd: 30, category: "women", image: "Women's Handbag" }
            ],
            children: [
                { id: 11, name: "Kids Nike Shoes", price: 20000, rwf: 20000, usd: 20, category: "children", image: "Kids Nike Shoes" },
                { id: 12, name: "Kids T-Shirt", price: 8000, rwf: 8000, usd: 8, category: "children", image: "Kids T-Shirt" },
                { id: 13, name: "Kids Jeans", price: 12000, rwf: 12000, usd: 12, category: "children", image: "Kids Jeans" },
                { id: 14, name: "Kids Jacket", price: 18000, rwf: 18000, usd: 18, category: "children", image: "Kids Jacket" },
                { id: 15, name: "Kids Backpack", price: 15000, rwf: 15000, usd: 15, category: "children", image: "Kids Backpack" }
            ],
            food: [
                { id: 16, name: "Local Food Package", price: 15000, rwf: 15000, usd: 15, category: "food", image: "Local Food" },
                { id: 17, name: "Fresh Fruits Basket", price: 12000, rwf: 12000, usd: 12, category: "food", image: "Fruits Basket" },
                { id: 18, name: "Organic Vegetables", price: 10000, rwf: 10000, usd: 10, category: "food", image: "Organic Vegetables" },
                { id: 19, name: "Traditional Snacks", price: 8000, rwf: 8000, usd: 8, category: "food", image: "Traditional Snacks" },
                { id: 20, name: "Spices Collection", price: 18000, rwf: 18000, usd: 18, category: "food", image: "Spices Collection" }
            ]
        };
        
        // Shopping cart
        let cart = [];
        
        // Navigation functionality
        document.querySelectorAll('.menu-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const pageId = this.getAttribute('data-page');
                showPage(pageId);
            });
        });

        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Update cart if needed
            if (pageId === 'cart') {
                updateCartDisplay();
            }
            
            // Update payment amount if needed
            if (pageId === 'payment') {
                updatePaymentAmount();
            }
            
            // Load products if needed
            if (pageId === 'products') {
                loadProducts('men');
            }
            
            // Load wallet if needed
            if (pageId === 'wallet') {
                loadWalletData();
            }
            
            // Load referral if needed
            if (pageId === 'referral') {
                loadReferralData();
            }
            
            // Load admin data if needed
            if (pageId === 'admin') {
                loadAdminProducts();
                loadAdminOrders();
                loadAdminLocations();
                loadPaymentSettings();
                loadAdminWalletTransactions();
            }
        }

        // Load products for a category
        function loadProducts(category) {
            const productsContainer = document.getElementById('products-container');
            productsContainer.innerHTML = '';
            
            const allProducts = getFromDB(DB_KEYS.PRODUCTS);
            
            allProducts[category].forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.setAttribute('data-category', category);
                
                // Check if user is logged in
                const addToCartButton = isLoggedIn ? 
                    `<button class="add-to-cart" data-product="${product.id}">Add to Cart</button>` :
                    `<button class="add-to-cart" disabled>Login to Purchase</button>`;
                
                // Check if product is on sale
                const badge = product.price <= 15000 ? '<div class="product-badge">Sale</div>' : '';
                
                productCard.innerHTML = `
                    <div class="product-image">
                        ${badge}
                        <span>${product.image}</span>
                    </div>
                    <div class="product-info">
                        <h3>${product.name}</h3>
                        <p>High quality ${product.name.toLowerCase()} for ${category}</p>
                        <div class="product-price">${product.rwf.toLocaleString()} RWF / $${product.usd}</div>
                        ${addToCartButton}
                    </div>
                    ${!isLoggedIn ? '<div class="login-required"><p>Please login to purchase products</p><button class="btn menu-link" data-page="login">Login Now</button></div>' : ''}
                `;
                
                productsContainer.appendChild(productCard);
            });
            
            // Add event listeners to add to cart buttons
            document.querySelectorAll('.add-to-cart:not(:disabled)').forEach(button => {
                button.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product'));
                    addToCart(productId);
                });
            });
        }

        // Add product to cart
        function addToCart(productId) {
            // Find product in all categories
            const allProducts = getFromDB(DB_KEYS.PRODUCTS);
            let product = null;
            for (const category in allProducts) {
                product = allProducts[category].find(p => p.id === productId);
                if (product) break;
            }
            
            if (!product) return;
            
            // Check if product already in cart
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    rwf: product.rwf,
                    usd: product.usd,
                    quantity: 1
                });
            }
            
            // Save cart to localStorage
            saveToDB(DB_KEYS.CART, cart);
            
            showNotification(`${product.name} added to cart!`, 'success');
        }

        // Toggle password visibility
        document.querySelectorAll('.toggle-password').forEach(toggle => {
            toggle.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                const passwordInput = document.getElementById(targetId);
                const icon = this.querySelector('i');
                
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    passwordInput.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        });

        // Product category filtering
        document.querySelectorAll('.category-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Update active tab
                document.querySelectorAll('.category-tab').forEach(t => {
                    t.classList.remove('active');
                });
                this.classList.add('active');
                
                // Load products for this category
                const category = this.getAttribute('data-category');
                loadProducts(category);
            });
        });

        function updateCartDisplay() {
            const cartItems = document.querySelector('.cart-items');
            const totalPriceElement = document.querySelector('.total-price');
            
            // Load cart from localStorage
            cart = getFromDB(DB_KEYS.CART) || [];
            
            // Clear current cart display
            cartItems.innerHTML = '';
            
            let totalPrice = 0;
            
            // Add each item to cart display
            cart.forEach(item => {
                totalPrice += item.price * item.quantity;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-image">${item.name.charAt(0)}</div>
                    <div class="cart-item-details">
                        <h3>${item.name}</h3>
                        <div class="cart-item-price">${item.rwf.toLocaleString()} RWF</div>
                        <div class="quantity-controls">
                            <button class="quantity-btn decrease" data-product="${item.id}">-</button>
                            <span class="quantity">${item.quantity}</span>
                            <button class="quantity-btn increase" data-product="${item.id}">+</button>
                        </div>
                    </div>
                `;
                
                cartItems.appendChild(cartItem);
            });
            
            // Update total price
            totalPriceElement.textContent = `Total: ${totalPrice.toLocaleString()} RWF`;
            
            // Add event listeners for quantity controls
            document.querySelectorAll('.quantity-btn.increase').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product'));
                    const item = cart.find(i => i.id === productId);
                    if (item) {
                        item.quantity += 1;
                        saveToDB(DB_KEYS.CART, cart);
                        updateCartDisplay();
                    }
                });
            });
            
            document.querySelectorAll('.quantity-btn.decrease').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product'));
                    const item = cart.find(i => i.id === productId);
                    if (item) {
                        item.quantity -= 1;
                        if (item.quantity <= 0) {
                            cart = cart.filter(i => i.id !== productId);
                        }
                        saveToDB(DB_KEYS.CART, cart);
                        updateCartDisplay();
                    }
                });
            });
        }

        // Checkout functionality
        document.getElementById('checkout-btn').addEventListener('click', function() {
            if (cart.length === 0) {
                showNotification('Your cart is empty!', 'error');
                return;
            }
            
            // In a real implementation, this would check if user is logged in
            // For this demo, we'll just go to payment page
            showPage('payment');
        });

        // Payment method selection
        document.querySelectorAll('.payment-method').forEach(method => {
            method.addEventListener('click', function() {
                // Update active payment method
                document.querySelectorAll('.payment-method').forEach(m => {
                    m.classList.remove('active');
                });
                this.classList.add('active');
                
                // Show corresponding payment details
                const methodType = this.getAttribute('data-method');
                document.querySelectorAll('.payment-details').forEach(details => {
                    details.classList.remove('active');
                });
                document.getElementById(`${methodType}-payment`).classList.add('active');
                
                // Update wallet balance display if wallet payment
                if (methodType === 'wallet') {
                    document.getElementById('wallet-balance-display').value = `$${currentUser.walletBalance.toFixed(2)}`;
                    document.getElementById('wallet-payment-amount').value = document.getElementById('payment-amount').value;
                }
            });
        });

        function updatePaymentAmount() {
            let totalPrice = 0;
            cart.forEach(item => {
                totalPrice += item.price * item.quantity;
            });
            
            // Update payment amount displays
            document.getElementById('payment-amount').value = `${totalPrice.toLocaleString()} RWF`;
            
            // Convert to USD (approximate conversion)
            const usdAmount = (totalPrice / 1000).toFixed(2);
            document.getElementById('binance-amount').value = `$${usdAmount}`;
        }

        // Payment submission
        document.getElementById('submit-mobile-payment').addEventListener('click', function() {
            const proofFile = document.getElementById('payment-proof').files[0];
            if (!proofFile) {
                showNotification('Please upload payment proof screenshot', 'error');
                return;
            }
            
            // Create order
            const order = {
                id: Date.now(),
                customer: currentUser ? currentUser.name : 'Guest',
                email: currentUser ? currentUser.email : 'guest@example.com',
                items: [...cart],
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                paymentMethod: 'mobile',
                status: 'pending',
                date: new Date().toLocaleDateString()
            };
            
            // Save order to database
            const orders = getFromDB(DB_KEYS.ORDERS);
            orders.push(order);
            saveToDB(DB_KEYS.ORDERS, orders);
            
            // Send notification email
            sendEmailNotification(
                "New Mobile Money Payment",
                `A customer has submitted a mobile money payment of ${document.getElementById('payment-amount').value}. Please check the attached proof.`
            );
            
            // In a real implementation, this would send to server for verification
            showNotification('Payment submitted! Our team will verify your payment and confirm your order shortly.', 'success');
            cart = [];
            saveToDB(DB_KEYS.CART, cart);
            showPage('home');
        });

        document.getElementById('submit-binance-payment').addEventListener('click', function() {
            const proofFile = document.getElementById('binance-proof').files[0];
            if (!proofFile) {
                showNotification('Please upload payment proof screenshot', 'error');
                return;
            }
            
            // Create order
            const order = {
                id: Date.now(),
                customer: currentUser ? currentUser.name : 'Guest',
                email: currentUser ? currentUser.email : 'guest@example.com',
                items: [...cart],
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                paymentMethod: 'binance',
                status: 'pending',
                date: new Date().toLocaleDateString()
            };
            
            // Save order to database
            const orders = getFromDB(DB_KEYS.ORDERS);
            orders.push(order);
            saveToDB(DB_KEYS.ORDERS, orders);
            
            // Send notification email
            sendEmailNotification(
                "New Binance Payment",
                `A customer has submitted a Binance payment of ${document.getElementById('binance-amount').value}. Please check the attached proof.`
            );
            
            // In a real implementation, this would send to server for verification
            showNotification('Payment submitted! Our team will verify your payment and confirm your order shortly.', 'success');
            cart = [];
            saveToDB(DB_KEYS.CART, cart);
            showPage('home');
        });

        // Wallet payment
        document.getElementById('submit-wallet-payment').addEventListener('click', function() {
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const usdAmount = totalPrice / 1000;
            
            if (currentUser.walletBalance < usdAmount) {
                showNotification('Insufficient wallet balance!', 'error');
                return;
            }
            
            // Deduct from wallet
            const users = getFromDB(DB_KEYS.USERS);
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            users[userIndex].walletBalance -= usdAmount;
            saveToDB(DB_KEYS.USERS, users);
            
            // Update current user
            currentUser = users[userIndex];
            
            // Create wallet transaction
            const walletTransactions = getFromDB(DB_KEYS.WALLET_TRANSACTIONS);
            walletTransactions.push({
                id: Date.now(),
                userId: currentUser.id,
                type: 'purchase',
                amount: usdAmount,
                description: 'Purchase from TUNGA NAKANGAKA',
                date: new Date().toLocaleDateString(),
                status: 'completed'
            });
            saveToDB(DB_KEYS.WALLET_TRANSACTIONS, walletTransactions);
            
            // Create order
            const order = {
                id: Date.now(),
                customer: currentUser.name,
                email: currentUser.email,
                items: [...cart],
                total: totalPrice,
                paymentMethod: 'wallet',
                status: 'completed',
                date: new Date().toLocaleDateString()
            };
            
            // Save order to database
            const orders = getFromDB(DB_KEYS.ORDERS);
            orders.push(order);
            saveToDB(DB_KEYS.ORDERS, orders);
            
            showNotification('Payment successful! Your order has been placed.', 'success');
            cart = [];
            saveToDB(DB_KEYS.CART, cart);
            showPage('home');
        });

        // Login and signup functionality
        document.getElementById('login-btn').addEventListener('click', function() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (!email || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            // Check user credentials
            const users = getFromDB(DB_KEYS.USERS);
            const user = users.find(u => 
                (u.email === email || u.phone === email) && u.password === password
            );
            
            if (!user) {
                showNotification('Invalid email/phone or password', 'error');
                return;
            }
            
            // Send notification email
            sendEmailNotification(
                "User Login",
                `A user with email/phone: ${email} has logged into the TUNGA NAKANGAKA website.`
            );
            
            // Set user as logged in
            isLoggedIn = true;
            currentUser = user;
            isAdmin = user.isAdmin || false;
            
            // Update UI
            document.getElementById('login-link').textContent = 'Logout';
            document.getElementById('login-link').setAttribute('data-page', 'logout');
            
            if (isAdmin) {
                document.getElementById('admin-link').style.display = 'block';
            }
            
            showNotification('Login successful!', 'success');
            showPage('products');
        });

        document.getElementById('signup-btn').addEventListener('click', function() {
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const phone = document.getElementById('signup-phone').value;
            const password = document.getElementById('signup-password').value;
            const referralCode = document.getElementById('referral-code').value;
            
            if (!name || !email || !phone || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            // Validate password strength
            const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
            if (!passwordRegex.test(password)) {
                showNotification('Password must be at least 8 characters with one number, one uppercase letter, and one symbol', 'error');
                return;
            }
            
            // Check if user already exists
            const users = getFromDB(DB_KEYS.USERS);
            const existingUser = users.find(u => u.email === email || u.phone === phone);
            if (existingUser) {
                showNotification('User with this email or phone already exists', 'error');
                return;
            }
            
            // Check referral code if provided
            let referredBy = null;
            if (referralCode) {
                const referrer = users.find(u => u.referralCode === referralCode);
                if (referrer) {
                    referredBy = referrer.id;
                    
                    // Add to referrals
                    const referrals = getFromDB(DB_KEYS.REFERRALS);
                    referrals.push({
                        id: Date.now(),
                        referrerId: referrer.id,
                        referredEmail: email,
                        date: new Date().toLocaleDateString(),
                        status: 'pending',
                        bonusPaid: false
                    });
                    saveToDB(DB_KEYS.REFERRALS, referrals);
                } else {
                    showNotification('Invalid referral code', 'error');
                    return;
                }
            }
            
            // Create new user
            const newUser = {
                id: Date.now(),
                name: name,
                email: email,
                phone: phone,
                password: password,
                isAdmin: false,
                walletBalance: 0,
                referralCode: generateReferralCode(),
                referredBy: referredBy
            };
            
            users.push(newUser);
            saveToDB(DB_KEYS.USERS, users);
            
            // Send notification email
            sendEmailNotification(
                "New User Registration",
                `A new user has registered on the TUNGA NAKANGAKA website:
                Name: ${name}
                Email: ${email}
                Phone: ${phone}`
            );
            
            // Set user as logged in
            isLoggedIn = true;
            currentUser = newUser;
            isAdmin = false;
            
            // Update UI
            document.getElementById('login-link').textContent = 'Logout';
            document.getElementById('login-link').setAttribute('data-page', 'logout');
            
            // In a real implementation, this would send verification code to email
            showNotification('Account created successfully! You are now logged in.', 'success');
            showPage('products');
        });

        // Logout functionality
        document.addEventListener('click', function(e) {
            if (e.target && e.target.getAttribute('data-page') === 'logout') {
                e.preventDefault();
                isLoggedIn = false;
                currentUser = null;
                isAdmin = false;
                cart = [];
                saveToDB(DB_KEYS.CART, cart);
                
                // Update UI
                document.getElementById('login-link').textContent = 'Login';
                document.getElementById('login-link').setAttribute('data-page', 'login');
                document.getElementById('admin-link').style.display = 'none';
                
                showNotification('You have been logged out.', 'info');
                showPage('home');
            }
        });

        // Forgot password functionality
        document.getElementById('reset-btn').addEventListener('click', function() {
            const email = document.getElementById('reset-email').value;
            
            if (!email) {
                showNotification('Please enter your email address', 'error');
                return;
            }
            
            // Check if user exists
            const users = getFromDB(DB_KEYS.USERS);
            const user = users.find(u => u.email === email);
            
            if (!user) {
                showNotification('No account found with this email address', 'error');
                return;
            }
            
            // Generate reset code
            const resetCode = Math.floor(100000 + Math.random() * 900000).toString();
            
            // Save reset code to database
            const resetCodes = getFromDB(DB_KEYS.RESET_CODES);
            resetCodes.push({
                email: email,
                code: resetCode,
                expires: Date.now() + 30 * 60 * 1000 // 30 minutes
            });
            saveToDB(DB_KEYS.RESET_CODES, resetCodes);
            
            // Send notification email with reset code
            sendEmailNotification(
                "Password Reset Code",
                `You have requested to reset your password for TUNGA NAKANGAKA.
                Your reset code is: ${resetCode}
                This code will expire in 30 minutes.`
            );
            
            // Store email for verification
            sessionStorage.setItem('resetEmail', email);
            
            showNotification('Password reset code sent to your email!', 'success');
            showPage('reset-password');
        });

        // Reset password with code functionality
        document.getElementById('reset-password-btn').addEventListener('click', function() {
            const code = document.getElementById('reset-code').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (!code || !newPassword || !confirmPassword) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }
            
            // Validate password strength
            const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
            if (!passwordRegex.test(newPassword)) {
                showNotification('Password must be at least 8 characters with one number, one uppercase letter, and one symbol', 'error');
                return;
            }
            
            // Get email from session storage
            const email = sessionStorage.getItem('resetEmail');
            if (!email) {
                showNotification('Reset session expired. Please request a new code.', 'error');
                showPage('forgot-password');
                return;
            }
            
            // Verify reset code
            const resetCodes = getFromDB(DB_KEYS.RESET_CODES);
            const resetEntry = resetCodes.find(rc => 
                rc.email === email && rc.code === code && rc.expires > Date.now()
            );
            
            if (!resetEntry) {
                showNotification('Invalid or expired reset code', 'error');
                return;
            }
            
            // Update user password
            const users = getFromDB(DB_KEYS.USERS);
            const userIndex = users.findIndex(u => u.email === email);
            
            if (userIndex !== -1) {
                users[userIndex].password = newPassword;
                saveToDB(DB_KEYS.USERS, users);
                
                // Remove used reset code
                const updatedResetCodes = resetCodes.filter(rc => rc.email !== email);
                saveToDB(DB_KEYS.RESET_CODES, updatedResetCodes);
                
                // Clear session storage
                sessionStorage.removeItem('resetEmail');
                
                showNotification('Password reset successfully! You can now login with your new password.', 'success');
                showPage('login');
            } else {
                showNotification('User not found', 'error');
            }
        });

        // Contact form submission
        document.getElementById('contact-submit').addEventListener('click', function() {
            const name = document.getElementById('contact-name').value;
            const email = document.getElementById('contact-email').value;
            const phone = document.getElementById('contact-phone').value;
            const message = document.getElementById('contact-message').value;
            
            if (!name || !email || !phone || !message) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            // Send notification email
            sendEmailNotification(
                "New Contact Form Submission",
                `A customer has submitted a contact form on the TUNGA NAKANGAKA website:
                Name: ${name}
                Email: ${email}
                Phone: ${phone}
                Message: ${message}`
            );
            
            showNotification('Message sent successfully! We will get back to you soon.', 'success');
            
            // Clear form
            document.getElementById('contact-name').value = '';
            document.getElementById('contact-email').value = '';
            document.getElementById('contact-phone').value = '';
            document.getElementById('contact-message').value = '';
        });

        // Wallet functionality
        function loadWalletData() {
            if (!isLoggedIn) {
                showNotification('Please login to access wallet', 'error');
                showPage('login');
                return;
            }
            
            // Update wallet balance
            document.getElementById('wallet-balance').textContent = `$${currentUser.walletBalance.toFixed(2)}`;
            
            // Load transaction history
            const transactionHistory = document.getElementById('transaction-history');
            transactionHistory.innerHTML = '';
            
            const walletTransactions = getFromDB(DB_KEYS.WALLET_TRANSACTIONS);
            const userTransactions = walletTransactions.filter(t => t.userId === currentUser.id);
            
            userTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${transaction.date}</td>
                    <td>${transaction.description}</td>
                    <td class="transaction-type ${transaction.type}">${transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1)}</td>
                    <td>$${transaction.amount.toFixed(2)}</td>
                    <td>${transaction.status}</td>
                `;
                transactionHistory.appendChild(row);
            });
        }

        // Deposit functionality
        document.getElementById('deposit-btn').addEventListener('click', function() {
            if (!isLoggedIn) {
                showNotification('Please login to deposit funds', 'error');
                showPage('login');
                return;
            }
            
            document.getElementById('deposit-modal').style.display = 'flex';
        });

        document.getElementById('cancel-deposit').addEventListener('click', function() {
            document.getElementById('deposit-modal').style.display = 'none';
        });

        document.getElementById('confirm-deposit').addEventListener('click', function() {
            const amount = parseFloat(document.getElementById('deposit-amount').value);
            const method = document.getElementById('deposit-method').value;
            
            if (!amount || amount < 5 || amount > 30000) {
                showNotification('Please enter a valid amount between $5 and $30,000', 'error');
                return;
            }
            
            // Create wallet transaction
            const walletTransactions = getFromDB(DB_KEYS.WALLET_TRANSACTIONS);
            walletTransactions.push({
                id: Date.now(),
                userId: currentUser.id,
                type: 'deposit',
                amount: amount,
                description: `Deposit via ${method}`,
                date: new Date().toLocaleDateString(),
                status: 'pending'
            });
            saveToDB(DB_KEYS.WALLET_TRANSACTIONS, walletTransactions);
            
            // Check if this is a first deposit from a referred user
            if (currentUser.referredBy) {
                const referrals = getFromDB(DB_KEYS.REFERRALS);
                const referral = referrals.find(r => r.referredEmail === currentUser.email && r.status === 'pending');
                
                if (referral && amount >= 5) {
                    // Update referral status
                    referral.status = 'completed';
                    referral.bonusPaid = false;
                    saveToDB(DB_KEYS.REFERRALS, referrals);
                    
                    // Add bonus to referrer
                    const users = getFromDB(DB_KEYS.USERS);
                    const referrerIndex = users.findIndex(u => u.id === currentUser.referredBy);
                    if (referrerIndex !== -1) {
                        users[referrerIndex].walletBalance += 6;
                        
                        // Create bonus transaction for referrer
                        walletTransactions.push({
                            id: Date.now() + 1,
                            userId: currentUser.referredBy,
                            type: 'bonus',
                            amount: 6,
                            description: `Referral bonus from ${currentUser.name}`,
                            date: new Date().toLocaleDateString(),
                            status: 'completed'
                        });
                        
                        saveToDB(DB_KEYS.USERS, users);
                        saveToDB(DB_KEYS.WALLET_TRANSACTIONS, walletTransactions);
                        
                        // Update current user if needed
                        if (currentUser.id === users[referrerIndex].id) {
                            currentUser = users[referrerIndex];
                        }
                    }
                }
            }
            
            document.getElementById('deposit-modal').style.display = 'none';
            showNotification('Deposit request submitted! Please complete the payment.', 'success');
            loadWalletData();
        });

        // Withdrawal functionality
        document.getElementById('withdraw-btn').addEventListener('click', function() {
            if (!isLoggedIn) {
                showNotification('Please login to withdraw funds', 'error');
                showPage('login');
                return;
            }
            
            if (currentUser.walletBalance < 5) {
                showNotification('Minimum withdrawal amount is $5', 'error');
                return;
            }
            
            document.getElementById('withdrawal-modal').style.display = 'flex';
        });

        document.getElementById('cancel-withdrawal').addEventListener('click', function() {
            document.getElementById('withdrawal-modal').style.display = 'none';
        });

        document.getElementById('confirm-withdrawal').addEventListener('click', function() {
            const amount = parseFloat(document.getElementById('withdrawal-amount').value);
            const method = document.getElementById('withdrawal-method').value;
            const accountDetails = document.getElementById('account-details').value;
            
            if (!amount || amount < 5 || amount > 30000) {
                showNotification('Please enter a valid amount between $5 and $30,000', 'error');
                return;
            }
            
            if (amount > currentUser.walletBalance) {
                showNotification('Insufficient wallet balance', 'error');
                return;
            }
            
            if (!accountDetails) {
                showNotification('Please enter your account details', 'error');
                return;
            }
            
            // Update user wallet balance
            const users = getFromDB(DB_KEYS.USERS);
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            users[userIndex].walletBalance -= amount;
            saveToDB(DB_KEYS.USERS, users);
            
            // Update current user
            currentUser = users[userIndex];
            
            // Create wallet transaction
            const walletTransactions = getFromDB(DB_KEYS.WALLET_TRANSACTIONS);
            walletTransactions.push({
                id: Date.now(),
                userId: currentUser.id,
                type: 'withdrawal',
                amount: amount,
                description: `Withdrawal to ${accountDetails} via ${method}`,
                date: new Date().toLocaleDateString(),
                status: 'pending'
            });
            saveToDB(DB_KEYS.WALLET_TRANSACTIONS, walletTransactions);
            
            document.getElementById('withdrawal-modal').style.display = 'none';
            showNotification('Withdrawal request submitted! It will be processed within 24 hours.', 'success');
            loadWalletData();
        });

        // Referral functionality
        function loadReferralData() {
            if (!isLoggedIn) {
                showNotification('Please login to access referral program', 'error');
                showPage('login');
                return;
            }
            
            // Update referral link
            document.getElementById('referral-link-input').value = `${window.location.origin}?ref=${currentUser.referralCode}`;
            
            // Load referral stats
            const referrals = getFromDB(DB_KEYS.REFERRALS);
            const userReferrals = referrals.filter(r => r.referrerId === currentUser.id);
            const completedReferrals = userReferrals.filter(r => r.status === 'completed');
            const pendingReferrals = userReferrals.filter(r => r.status === 'pending');
            
            document.getElementById('total-referrals').textContent = userReferrals.length;
            document.getElementById('total-bonus').textContent = `$${(completedReferrals.length * 6).toFixed(2)}`;
            document.getElementById('pending-bonus').textContent = `$${(pendingReferrals.length * 6).toFixed(2)}`;
            
            // Load referral history
            const referralHistory = document.getElementById('referral-history');
            referralHistory.innerHTML = '';
            
            userReferrals.forEach(referral => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${referral.referredEmail}</td>
                    <td>${referral.date}</td>
                    <td>${referral.status === 'completed' ? 'Yes' : 'No'}</td>
                    <td>${referral.status === 'completed' ? (referral.bonusPaid ? 'Paid' : 'Pending') : 'Waiting for deposit'}</td>
                    <td>${referral.status === 'completed' ? '$6.00' : '$0.00'}</td>
                `;
                referralHistory.appendChild(row);
            });
        }

        // Copy referral link
        document.getElementById('copy-referral-link').addEventListener('click', function() {
            const referralLink = document.getElementById('referral-link-input');
            referralLink.select();
            document.execCommand('copy');
            showNotification('Referral link copied to clipboard!', 'success');
        });

        // Admin panel functionality
        document.querySelectorAll('.admin-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Update active tab
                document.querySelectorAll('.admin-tab').forEach(t => {
                    t.classList.remove('active');
                });
                this.classList.add('active');
                
                // Show corresponding section
                const sectionId = this.getAttribute('data-section');
                document.querySelectorAll('.admin-section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(`admin-${sectionId}`).classList.add('active');
            });
        });

        // Load admin products
        function loadAdminProducts() {
            const productsTable = document.getElementById('admin-products-table');
            productsTable.innerHTML = '';
            
            const allProducts = getFromDB(DB_KEYS.PRODUCTS);
            
            for (const category in allProducts) {
                allProducts[category].forEach(product => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${product.id}</td>
                        <td>${product.name}</td>
                        <td>${category}</td>
                        <td>${product.rwf.toLocaleString()}</td>
                        <td>
                            <button class="action-btn edit-btn" data-product="${product.id}" data-category="${category}">Edit</button>
                            <button class="action-btn delete-btn" data-product="${product.id}" data-category="${category}">Delete</button>
                        </td>
                    `;
                    productsTable.appendChild(row);
                });
            }
            
            // Add event listeners for edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product'));
                    const category = this.getAttribute('data-category');
                    editProduct(productId, category);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product'));
                    const category = this.getAttribute('data-category');
                    deleteProduct(productId, category);
                });
            });
        }

        // Load admin orders
        function loadAdminOrders() {
            const ordersTable = document.getElementById('admin-orders-table');
            ordersTable.innerHTML = '';
            
            const orders = getFromDB(DB_KEYS.ORDERS);
            
            orders.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.id}</td>
                    <td>${order.customer}</td>
                    <td>${order.total.toLocaleString()} RWF</td>
                    <td>${order.status}</td>
                    <td>${order.date}</td>
                    <td>
                        <button class="action-btn edit-btn" data-order="${order.id}">View</button>
                        <button class="action-btn delete-btn" data-order="${order.id}">Delete</button>
                    </td>
                `;
                ordersTable.appendChild(row);
            });
        }

        // Load admin locations
        function loadAdminLocations() {
            const locationsTable = document.getElementById('admin-locations-table');
            locationsTable.innerHTML = '';
            
            const locations = getFromDB(DB_KEYS.LOCATIONS);
            
            locations.forEach(location => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${location.name}</td>
                    <td>${location.address}</td>
                    <td>${location.active ? 'Active' : 'Inactive'}</td>
                    <td>
                        <button class="action-btn edit-btn" data-location="${location.id}">Edit</button>
                        <button class="action-btn delete-btn" data-location="${location.id}">Delete</button>
                    </td>
                `;
                locationsTable.appendChild(row);
            });
        }

        // Load admin wallet transactions
        function loadAdminWalletTransactions() {
            const transactionsTable = document.getElementById('admin-wallet-transactions-table');
            transactionsTable.innerHTML = '';
            
            const walletTransactions = getFromDB(DB_KEYS.WALLET_TRANSACTIONS);
            const users = getFromDB(DB_KEYS.USERS);
            
            walletTransactions.forEach(transaction => {
                const user = users.find(u => u.id === transaction.userId);
                const userName = user ? user.name : 'Unknown User';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${userName}</td>
                    <td>${transaction.type}</td>
                    <td>$${transaction.amount.toFixed(2)}</td>
                    <td>${transaction.date}</td>
                    <td>${transaction.status}</td>
                    <td>
                        <button class="action-btn edit-btn" data-transaction="${transaction.id}">Update</button>
                    </td>
                `;
                transactionsTable.appendChild(row);
            });
        }

        // Load payment settings
        function loadPaymentSettings() {
            const paymentSettings = getFromDB(DB_KEYS.PAYMENT_SETTINGS);
            document.getElementById('mobile-money-number').value = paymentSettings.mobileMoneyNumber;
            document.getElementById('binance-email-admin').value = paymentSettings.binanceEmail;
        }

        // Save payment settings
        document.getElementById('save-payment-settings').addEventListener('click', function() {
            const mobileMoneyNumber = document.getElementById('mobile-money-number').value;
            const binanceEmail = document.getElementById('binance-email-admin').value;
            
            const paymentSettings = {
                mobileMoneyNumber: mobileMoneyNumber,
                binanceEmail: binanceEmail
            };
            
            saveToDB(DB_KEYS.PAYMENT_SETTINGS, paymentSettings);
            
            // Update payment page with new settings
            document.getElementById('mobile-number').value = mobileMoneyNumber;
            document.getElementById('binance-email').value = binanceEmail;
            
            showNotification('Payment settings updated successfully!', 'success');
        });

        // Edit product function
        function editProduct(productId, category) {
            const allProducts = getFromDB(DB_KEYS.PRODUCTS);
            const product = allProducts[category].find(p => p.id === productId);
            
            if (product) {
                const newName = prompt('Enter new product name:', product.name);
                if (newName) product.name = newName;
                
                const newPrice = prompt('Enter new price (RWF):', product.rwf);
                if (newPrice) {
                    product.rwf = parseInt(newPrice);
                    product.price = parseInt(newPrice);
                    product.usd = Math.round(parseInt(newPrice) / 1000);
                }
                
                saveToDB(DB_KEYS.PRODUCTS, allProducts);
                loadAdminProducts();
                showNotification('Product updated successfully!', 'success');
            }
        }

        // Delete product function
        function deleteProduct(productId, category) {
            if (confirm('Are you sure you want to delete this product?')) {
                const allProducts = getFromDB(DB_KEYS.PRODUCTS);
                allProducts[category] = allProducts[category].filter(p => p.id !== productId);
                saveToDB(DB_KEYS.PRODUCTS, allProducts);
                loadAdminProducts();
                showNotification('Product deleted successfully!', 'success');
            }
        }

        // Notification system
        function showNotification(message, type) {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => {
                notification.remove();
            });
            
            // Create new notification
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            let icon = 'fa-info-circle';
            if (type === 'success') icon = 'fa-check-circle';
            if (type === 'error') icon = 'fa-exclamation-circle';
            
            notification.innerHTML = `
                <i class="fas ${icon}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Email notification function (simulated)
        function sendEmailNotification(subject, body) {
            // In a real implementation, this would use a server-side service
            // to send actual emails. For this demo, we'll just log to console.
            console.log(`Email sent to ${COMPANY_EMAIL}`);
            console.log(`Subject: ${subject}`);
            console.log(`Body: ${body}`);
            
            // For demonstration purposes, we'll show a notification
            showNotification(`Notification sent to ${COMPANY_EMAIL}`, 'info');
        }

        // Check for referral code in URL
        function checkReferralCode() {
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            
            if (refCode) {
                document.getElementById('referral-code').value = refCode;
            }
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize database
            initializeDatabase();
            
            // Load cart from localStorage
            cart = getFromDB(DB_KEYS.CART) || [];
            
            // Check for referral code
            checkReferralCode();
            
            // Set up login/signup links
            document.getElementById('login-link').addEventListener('click', function(e) {
                e.preventDefault();
                if (this.getAttribute('data-page') === 'logout') {
                    // Logout functionality is handled separately
                    return;
                }
                showPage('login');
            });
            
            document.getElementById('signup-link').addEventListener('click', function(e) {
                e.preventDefault();
                showPage('signup');
            });
            
            document.getElementById('admin-link').addEventListener('click', function(e) {
                e.preventDefault();
                if (isAdmin) {
                    showPage('admin');
                } else {
                    showNotification('Access denied. Admin privileges required.', 'error');
                }
            });
            
            // Load initial products
            loadProducts('men');
        });
    </script>
</body>
</html>